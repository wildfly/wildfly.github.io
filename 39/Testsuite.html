<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<meta name="author" content="WildFly authors">
<title>WildFly Testsuite</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Stylesheet for CodeRay to loosely match GitHub themes | MIT License */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid;opacity:.35;padding:0 .5em 0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff!important;background:navy!important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:navy}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:teal}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:teal}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:teal}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:teal}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body id="Testsuite" class="book toc2 toc-left">
<div id="header">
<h1>WildFly Testsuite</h1>
<div class="details">
<span id="author" class="author">WildFly authors</span><br>
<span id="revnumber">version 39.0.0.Final,</span>
<span id="revdate">2026-01-16T13:13:11Z</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">WildFly testsuite</div>
<ul class="sectlevel1">
<li><a href="#WildFly_Testsuite_Overview">1. WildFly Testsuite Overview</a>
<ul class="sectlevel2">
<li><a href="#test-suite-organization">1.1. Test Suite Organization</a></li>
<li><a href="#profiles">1.2. Profiles</a></li>
<li><a href="#integration-tests">1.3. Integration tests</a>
<ul class="sectlevel3">
<li><a href="#smoke--dts.smoke--dts.nosmoke">1.3.1. Smoke <code>-Dts.smoke</code></a></li>
<li><a href="#basic--dts.basic">1.3.2. Basic <code>-Dts.basic</code></a></li>
<li><a href="#cluster--dts.clustering">1.3.3. Clustering <code>-Dts.clustering</code></a></li>
<li><a href="#running-infinispan-server-tests-against-custom-distribution">1.3.4. Running Infinispan Server tests against custom distribution</a></li>
<li><a href="#iiop--dts.iiop">1.3.5. IIOP <code>-Dts.iiop</code></a></li>
<li><a href="#xts--dts.xts">1.3.6. XTS <code>-Dts.XTS</code></a></li>
<li><a href="#multinode--dts.multinode">1.3.7. Multinode <code>-Dts.multinode</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#WildFly_Integration_Testsuite_User_Guide">2. WildFly Integration Testsuite User Guide</a>
<ul class="sectlevel2">
<li><a href="#running-the-testsuite">2.1. Running the testsuite</a>
<ul class="sectlevel3">
<li><a href="#supported-maven-phases">2.1.1. Supported Maven phases</a></li>
<li><a href="#testsuite-structure">2.1.2. Testsuite structure</a></li>
<li><a href="#test-groups">2.1.3. Test groups</a></li>
</ul>
</li>
<li><a href="#examples">2.2. Examples</a>
<ul class="sectlevel3">
<li><a href="#output-to-console">2.2.1. Output to console</a></li>
<li><a href="#other-options">2.2.2. Other options</a></li>
<li><a href="#timeouts">2.2.3. Timeouts</a></li>
<li><a href="#running-a-single-test-or-specified-tests">2.2.4. Running a single test (or specified tests)</a></li>
<li><a href="#running-against-existing-as-copy-not-the-one-from-buildtargetjboss-as-">2.2.5. Running against existing AS copy (not the one from</a></li>
<li><a href="#running-with-a-debugger">2.2.6. Running with a debugger</a></li>
<li><a href="#running-tests-with-custom-database">2.2.7. Running tests with custom database</a></li>
<li><a href="#running-tests-with-ipv6">2.2.8. Running tests with IPv6</a></li>
<li><a href="#running-tests-with-security-manager-custom-security-policy">2.2.9. Running tests with security manager / custom security policy</a></li>
<li><a href="#creating-test-reports">2.2.10. Creating test reports</a></li>
<li><a href="#creating-coverage-reports">2.2.11. Creating coverage reports</a></li>
<li><a href="#cleaning-the-project">2.2.12. Cleaning the project</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#WildFly_Testsuite_Harness_Developer_Guide">3. WildFly Testsuite Harness Developer Guide</a>
<ul class="sectlevel2">
<li><a href="#adding-a-new-maven-plugin">3.1. Adding a new maven plugin</a></li>
<li><a href="#how-the-as-instance-is-built">3.2. How the AS instance is built</a></li>
<li><a href="#properties-and-their-propagation">3.3. Properties and their propagation</a>
<ul class="sectlevel3">
<li><a href="#jboss-as-instance-dir">3.3.1. JBoss AS instance dir</a></li>
<li><a href="#server-jvm-arguments">3.3.2. Server JVM arguments</a></li>
<li><a href="#ip-settings">3.3.3. IP settings</a></li>
<li><a href="#testsuite-directories">3.3.4. Testsuite directories</a></li>
<li><a href="#clustering-properties">3.3.5. Clustering properties</a></li>
</ul>
</li>
<li><a href="#debug-parameters-propagation">3.4. Debug parameters propagation</a></li>
<li><a href="#How_the_server_is_built_and_configured_for_testsuite_modules">3.5. How the WildFly is built and configured for testsuite modules</a>
<ul class="sectlevel3">
<li><a href="#arquillian-config-file-location">3.5.1. Arquillian config file location</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#WildFly_Testsuite_Test_Developer_Guide">4. WildFly Testsuite Test Developer Guide</a>
<ul class="sectlevel2">
<li><a href="#pre-requisites">4.1. Pre-requisites</a></li>
<li><a href="#managementclient-and-modelnode-usage-example">4.2. ManagementClient and ModelNode usage example</a></li>
<li><a href="#arquillian-features-available-in-tests">4.3. Arquillian features available in tests</a></li>
<li><a href="#properties-available-in-tests">4.4. Properties available in tests</a>
<ul class="sectlevel3">
<li><a href="#directories">4.4.1. Directories</a></li>
<li><a href="#networking">4.4.2. Networking</a></li>
<li><a href="#time-related-coefficients-ratios">4.4.3. Time-related coefficients (ratios)</a></li>
</ul>
</li>
<li><a href="#negative-tests">4.5. Negative tests</a></li>
<li><a href="#clustering-tests-wfly-616">4.6. Clustering tests (WFLY-616)</a></li>
<li><a href="#how-to-get-the-tests-to-main">4.7. How to get the tests to main branch</a></li>
</ul>
</li>
<li><a href="#How_to_Add_a_Test_Case">5. How to Add a Test Case</a>
<ul class="sectlevel2">
<li><a href="#create-a-test-case.">5.1. Create a test case</a></li>
<li><a href="#push-your-test-case-to-github-and-create-a-pull-request.">5.2. Push your test case to GitHub and create a pull request.</a></li>
</ul>
</li>
<li><a href="#Pre-requisites_-_test_quality_standards">6. Test Quality Standards</a>
<ul class="sectlevel2">
<li><a href="#verify-the-test-belongs-in-wildfly">6.1. Verify the Test Belongs in WildFly</a></li>
<li><a href="#add-only-correct-and-understandable-tests">6.2. Add Only Correct and Understandable Tests</a></li>
<li><a href="#avoid-duplicate-tests">6.3. Avoid Duplicate Tests</a></li>
<li><a href="#use-descriptive-test-names">6.4. Use Descriptive Test Names</a></li>
<li><a href="#document-tests-with-javadoc">6.5. Document Tests with Javadoc</a></li>
<li><a href="#expand-existing-tests-when-appropriate">6.6. Expand Existing Tests When Appropriate</a></li>
<li><a href="#organize-tests-by-subsystem">6.7. Organize Tests by Subsystem</a></li>
<li><a href="#document-non-obvious-specification-requirements">6.8. Document Non-Obvious Specification Requirements</a></li>
<li><a href="#collocate-test-resources-with-test-code">6.9. Collocate Test Resources with Test Code</a></li>
<li><a href="#use-configurable-values-for-urls-and-ports">6.10. Use Configurable Values for URLs and Ports</a></li>
<li><a href="#follow-best-practices-for-commits">6.11. Follow Best Practices for Commits</a></li>
<li><a href="#avoid-blind-timeouts">6.12. Avoid Blind Timeouts</a></li>
<li><a href="#provide-descriptive-assertion-messages">6.13. Provide Descriptive Assertion Messages</a></li>
<li><a href="#include-configuration-context-in-exceptions">6.14. Include Configuration Context in Exceptions</a></li>
<li><a href="#clean-up-resources">6.15. Clean Up Resources</a></li>
<li><a href="#keep-tests-configurable">6.16. Keep Tests Configurable</a></li>
<li><a href="#follow-coding-standards">6.17. Follow Coding Standards</a></li>
</ul>
</li>
<li><a href="#Shared_Test_Classes_and_Resources">7. Shared Test Classes and Resources</a>
<ul class="sectlevel2">
<li><a href="#among-testsuite-modules">7.1. Among Testsuite Modules</a></li>
<li><a href="#between-components-and-testsuite-modules">7.2. Between Components and Testsuite Modules</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<!-- toc disabled -->
</div>
</div>
<div class="sect1">
<h2 id="WildFly_Testsuite_Overview"><a class="anchor" href="#WildFly_Testsuite_Overview"></a>1. WildFly Testsuite Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document will detail the implementation of the testsuite integration submodule as it guides you on adding your own test cases.</p>
</div>
<div class="paragraph">
<p>The WildFly integration test suite has been designed with the following goals:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>support execution of all identified test case use cases</p>
</li>
<li>
<p>employ a design/organization which is scalable and maintainable</p>
</li>
<li>
<p>provide support for the automated measurement of test suite quality
(generation of feature coverage reports, code coverage reports)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, these requirements were considered:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>identifying distinct test case runs of the same test case with a
different set of client side parameters and server side parameters</p>
</li>
<li>
<p>separately maintaining server side execution results (e.g. logs, the
original server configuration) for post-execution debugging</p>
</li>
<li>
<p>running the testsuite in conjunction with a debugger</p>
</li>
<li>
<p>the execution of a single test (for debugging purposes)</p>
</li>
<li>
<p>running test cases against different container modes (managed in the
main, but also remote and embedded)</p>
</li>
<li>
<p>configuring client and server JVMs separately (e.g., IPv6 testing)</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="test-suite-organization"><a class="anchor" href="#test-suite-organization"></a>1.1. Test Suite Organization</h3>
<div class="paragraph">
<p>The testsuite module has a few submodules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>benchmark</strong> - holds all benchmark tests intended to assess relative
performance of specific feature</p>
</li>
<li>
<p><strong>domain</strong> - holds all domain management tests</p>
</li>
<li>
<p><strong>integration</strong> - holds all integration tests</p>
</li>
<li>
<p><strong>stress</strong> - holds all stress tests</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is expected that test contributions fit into one of these categories.</p>
</div>
<div class="paragraph">
<p>The <code>pom.xml</code> file located in the testsuite module is inherited by all
submodules and is used to do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>set defaults for common testsuite system properties (which can then be
overridden on the command line)</p>
</li>
<li>
<p>define dependencies common to all tests (Arquillian, junit or testng,
and container type)</p>
</li>
<li>
<p>provide a workaround for <code>@Resource(lookup=&#8230;&#8203;)</code> which requires
libraries in jbossas/endorsed</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It should not:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>define module-specific server configuration build steps</p>
</li>
<li>
<p>define module-specific surefire executions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These elements should be defined in logical profiles associated with
each logical grouping of tests; e.g., in the pom for the module which
contains the tests. The submodule poms contain additional details of
their function and purpose as well as expanded information as shown in
this document.</p>
</div>
</div>
<div class="sect2">
<h3 id="profiles"><a class="anchor" href="#profiles"></a>1.2. Profiles</h3>
<div class="paragraph">
<p>You should not activate the abovementioned profiles by -P, because that
disables other profiles which are activated by default.</p>
</div>
<div class="paragraph">
<p>Instead, you should always use activating properties, which are in
parentheses in the lists below.</p>
</div>
<div class="paragraph">
<p>Testsuite profiles are used to group tests into logical groups.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>all-modules.module.profile (all-modules)</p>
</li>
<li>
<p>integration.module.profile (integration.module)</p>
</li>
<li>
<p>compat.module.profile (compat.module)</p>
</li>
<li>
<p>domain.module.profile (domain.module)</p>
</li>
<li>
<p>benchmark.module.profile (benchmark.module)</p>
</li>
<li>
<p>stress.module.profile (stress.module)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>They also prepare WildFly instances and resources for respective
testsuite submodules.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>jpda.profile - sets surefire.jpda.args (debug)</p>
</li>
<li>
<p>ds.profile - sets database properties and prepares the datasource (ds=&lt;db id&gt;)</p>
<div class="ulist">
<ul>
<li>
<p>Has related database-specific profiles, like mysql51.profile etc.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Integration testsuite profiles configure surefire executions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>smoke.integration.tests.profile</p>
</li>
<li>
<p>basic.integration.tests.profile</p>
</li>
<li>
<p>clustering.integration.tests.profile</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="integration-tests"><a class="anchor" href="#integration-tests"></a>1.3. Integration tests</h3>
<div class="sect3">
<h4 id="smoke--dts.smoke--dts.nosmoke"><a class="anchor" href="#smoke--dts.smoke--dts.nosmoke"></a>1.3.1. Smoke <code>-Dts.smoke</code></h4>
<div class="paragraph">
<p>Contains smoke tests.</p>
</div>
<div class="paragraph">
<p>Runs by default; use <code>-Dts.noSmoke</code> to prevent running.</p>
</div>
<div class="paragraph">
<p>Tests should execute quickly.</p>
</div>
<div class="paragraph">
<p>Divided into two Surefire executions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One with full platform</p>
</li>
<li>
<p>Second with web profile (majority of tests).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="basic--dts.basic"><a class="anchor" href="#basic--dts.basic"></a>1.3.2. Basic <code>-Dts.basic</code></h4>
<div class="paragraph">
<p>Basic integration tests - those which do not need a special configuration
like cluster.</p>
</div>
<div class="paragraph">
<p>Divided into three Surefire executions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One with full platform,</p>
</li>
<li>
<p>Second with web profile (majority of tests).</p>
</li>
<li>
<p>Third with web profile, but needs to be run after server restart to
check whether persistent data are really persisted.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="cluster--dts.clustering"><a class="anchor" href="#cluster--dts.clustering"></a>1.3.3. Clustering <code>-Dts.clustering</code></h4>
<div class="paragraph">
<p>Contains all tests relating to clustering aspects of the application server, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>web session clustering,</p>
</li>
<li>
<p>Jakarta Enterprise Beans session clustering,</p>
</li>
<li>
<p>command dispatcher,</p>
</li>
<li>
<p>web session affinity handling,</p>
</li>
<li>
<p>and other areas.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Tests should leverage shared testing logic by extending <code>org.jboss.as.test.clustering.cluster.AbstractClusteringTestCase</code>.
The test case contract is that before executing the test method, all specified servers are started and all specified
deployments are deployed. This allows Arquillian resource injection into the test case.</p>
</div>
<div class="paragraph">
<p>There are four WildFly server instances, one load-balancer (Undertow) and one datagrid (Infinispan server) available
for the tests.</p>
</div>
<div class="sect4">
<h5 id="maven-profiles-and-parallelization"><a class="anchor" href="#maven-profiles-and-parallelization"></a>Maven profiles and Parallelization</h5>
<div class="paragraph">
<p>There are maven profiles that might come in handy for testing:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ts.clustering.common.profile</code> prepares server configurations used by test execution profiles</p>
</li>
<li>
<p><code>ts.clustering.cluster.ha.profile</code> runs tests against <code>standalone-ha.xml</code> profile</p>
</li>
<li>
<p><code>ts.clustering.cluster.fullha.profile</code> runs tests which require <code>standalone-full-ha.xml</code> profile; e.g. tests requiring JMS subsystem</p>
</li>
<li>
<p><code>ts.clustering.cluster.ha-infinispan-server.profile</code> runs tests against <code>standalone-ha.xml</code> profile with Infinispan Server provisioned via <code>@ClassRule</code></p>
</li>
<li>
<p><code>ts.clustering.single.profile</code> runs clustering tests that are using a non-HA server profile</p>
</li>
<li>
<p><code>ts.clustering.single.testable.profile</code> runs clustering tests that use <code>testable=true</code> deployments</p>
</li>
<li>
<p><code>ts.clustering.byteman.profile</code> runs clustering tests that require installation of byteman rules</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For instance, to only run tests that run against full-ha profile, activate clustering tests with <code>-Dts.clustering</code> and exclude
the other profiles with <code>-P</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">mvn -f testsuite/integration/clustering/pom.xml clean install -P&quot;-ts.clustering.cluster.ha.profile,-ts.clustering.cluster.fullha.profile,-ts.clustering.cluster.ha-infinispan-server.profile,-ts.clustering.single.profile,-ts.clustering.byteman.profile&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the testsuite can be run on multiple runners in parallel, the main execution (which takes the majority of the execution time)
can be split by packages using <code>-Dts.surefire.clustering.ha.additionalExcludes</code> property.
This property feeds a regular expression to exclude sub-packages of the <code>org.jboss.as.test.clustering.cluster</code> package.
The sub-packages at the time of writing are <code>affinity</code>, <code>cdi</code>, <code>dispatcher</code>, <code>ejb</code>, <code>ejb2</code>, <code>group</code>, <code>jms</code>, <code>jpa</code>,
<code>jsf</code>, <code>provider</code>, <code>registry</code>, <code>singleton</code>, <code>sso</code>, <code>web</code>, and <code>xsite</code>.
For instance, to parallelize testsuite execution on two machines (e.g. when using GitHub actions scripting or alike) the following commands
could be used to split the clustering tests into two executions of similar execution time, the first node can run the first half of the tests in sub-packages, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">./integration-tests.sh clean install -Dts.noSmoke -Dts.clustering -P=&quot;-ts.clustering.cluster.fullha.profile,-ts.clustering.cluster.ha-infinispan-server.profile,-ts.clustering.byteman.profile,-ts.clustering.single.profile&quot; -Dts.surefire.clustering.ha.additionalExcludes=affinity\|cdi\|dispatcher\|ejb\|ejb2\|group\|jms\|jpa</code></pre>
</div>
</div>
<div class="paragraph">
<p>while another node can concurrently run all the other profiles and the other half of sub-packages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">./integration-tests.sh clean install -Dts.noSmoke -Dts.clustering -Dts.surefire.clustering.ha.additionalExcludes=jsf\|provider\|registry\|singleton\|sso\|web\|xsite</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the test packages get out of sync with the excludes this will result in a test running multiple times, rather than tests being omitted.</p>
</div>
</div>
<div class="sect4">
<h5 id="running-a-single-test"><a class="anchor" href="#running-a-single-test"></a>Running a single test</h5>
<div class="paragraph">
<p>To run a single test, specifying <code>-Dtest=foo</code> is the standard way to do this. However, this overrides the includes/excludes
section of the surefire maven plugin execution. So, in case of the clustering testsuite, the profile which this test belongs
to, needs to be specified as well. For instance, to run a single test from the 'single' test execution, exclude the other
test profiles:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">./integration-tests.sh clean install -Dts.noSmoke -Dts.clustering -P=&quot;-ts.clustering.cluster.ha.profile,-ts.clustering.cluster.fullha.profile,-ts.clustering.cluster.ha-infinispan-server.profile,-ts.clustering.byteman.profile,-ts.clustering.single.profile&quot; -Dtest=org.jboss.as.test.clustering.single.dispatcher.CommandDispatcherTestCase</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-infinispan-server-tests-against-custom-distribution"><a class="anchor" href="#running-infinispan-server-tests-against-custom-distribution"></a>1.3.4. Running Infinispan Server tests against custom distribution</h4>
<div class="paragraph">
<p>To run the Infinispan Server-based tests against a custom distribution, a custom location can be specified with <code>-Dinfinispan.server.home.override=/foo/bar</code>
and <code>-Dinfinispan.server.profile.override=infinispan-13.0.xml</code> to use a corresponding server profile.
The distribution is then copied over to the build directories and patched with user credentials.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">./integration-tests.sh clean install -Dts.noSmoke -Dts.clustering -P=&quot;-ts.clustering.cluster.ha.profile,-ts.clustering.cluster.fullha.profile,-ts.clustering.single.profile,-ts.clustering.byteman.profile,-ts.clustering.single.profile&quot; -Dinfinispan.server.home.override=/Users/rhusar/Downloads/redhat-datagrid-8.3.0-server</code></pre>
</div>
</div>
<div class="paragraph">
<p>Should it be required, the Infinispan Server driver version can be also overridden by <code>-Dversion.org.infinispan.server.driver=13.0.0.Dev03</code>.</p>
</div>
<div class="sect4">
<h5 id="skipping-clustering-tests"><a class="anchor" href="#skipping-clustering-tests"></a>Skipping clustering tests</h5>
<div class="paragraph">
<p>To skip execution of all clustering tests use <code>-Dts.noClustering</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="iiop--dts.iiop"><a class="anchor" href="#iiop--dts.iiop"></a>1.3.5. IIOP <code>-Dts.iiop</code></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section is open for contributions.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="xts--dts.xts"><a class="anchor" href="#xts--dts.xts"></a>1.3.6. XTS <code>-Dts.XTS</code></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section is open for contributions.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="multinode--dts.multinode"><a class="anchor" href="#multinode--dts.multinode"></a>1.3.7. Multinode <code>-Dts.multinode</code></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section is open for contributions.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="WildFly_Integration_Testsuite_User_Guide"><a class="anchor" href="#WildFly_Integration_Testsuite_User_Guide"></a>2. WildFly Integration Testsuite User Guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>See also:</strong> <a href="#WildFly_Testsuite_Test_Developer_Guide">WildFly Testsuite Test Developer Guide</a></p>
</div>
<div class="paragraph">
<p><strong>Target Audience:</strong> Those interested in running the testsuite or a subset
thereof, with various configuration options.</p>
</div>
<div class="sect2">
<h3 id="running-the-testsuite"><a class="anchor" href="#running-the-testsuite"></a>2.1. Running the testsuite</h3>
<div class="paragraph">
<p>The tests can be run using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>build.sh</code> or <code>build.bat</code>, as a part of WildFly build.</p>
<div class="ulist">
<ul>
<li>
<p>By default, only smoke tests are run. To run all tests, run build.sh
install -DallTests.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>integration-tests.sh</code> or <code>integration-tests.bat</code>, a convenience
script which uses bundled Maven (currently 3.0.3), and runs all parent
testsuite modules (which configure the AS server).</p>
</li>
<li>
<p>pure maven run, using <code>mvn install</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The scripts are wrappers around Maven-based build. Their arguments are
passed to Maven (with few exceptions described below). This means you
can use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>build.sh (defaults to install)</p>
</li>
<li>
<p>build.sh install</p>
</li>
<li>
<p>build.sh clean install</p>
</li>
<li>
<p>integration-tests.sh install</p>
</li>
<li>
<p>&#8230;&#8203;etc.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="supported-maven-phases"><a class="anchor" href="#supported-maven-phases"></a>2.1.1. Supported Maven phases</h4>
<div class="paragraph">
<p>Testsuite actions are bounds to various Maven phases up to <code>verify</code>.
Running the build with earlier phases may fail in the submodules due to
missed configuration steps. Therefore, the only Maven phases you may
safely run, are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>clean</p>
</li>
<li>
<p>install</p>
</li>
<li>
<p>site</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>test</code> phase is not recommended to be used for scripted jobs as we
are planning to switch to the <code>failsafe</code> plugin bound to the
<code>integration-test</code> and <code>verify</code> phases. See
<a href="https://issues.redhat.com/browse/WFLY-625">WFLY-625</a> and
<a href="https://issues.redhat.com/browse/WFLY-228">WFLY-228</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="testsuite-structure"><a class="anchor" href="#testsuite-structure"></a>2.1.2. Testsuite structure</h4>
<div class="paragraph">
<p>testsuite<br>
integration<br>
smoke<br>
basic<br>
clust<br>
iiop<br>
multinode<br>
xts<br>
compat<br>
domain<br>
mixed-domain<br>
stress<br>
benchmark</p>
</div>
</div>
<div class="sect3">
<h4 id="test-groups"><a class="anchor" href="#test-groups"></a>2.1.3. Test groups</h4>
<div class="paragraph">
<p>To define groups of tests to be run, these properties are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-DallTests</code> - Runs all subgroups.</p>
</li>
<li>
<p><code>-DallInteg</code> - Runs all integration tests. Same as
<code>cd testsuite/integration; mvn clean install -DallTests</code></p>
</li>
<li>
<p><code>-Dts.integ</code> - Basic integration + clustering tests.</p>
</li>
<li>
<p><code>-Dts.clustering</code> - Clustering tests.</p>
</li>
<li>
<p><code>-Dts.iiop</code> - IIOP tests.</p>
</li>
<li>
<p>`-Dts.multinode `- Tests with many nodes.</p>
</li>
<li>
<p><code>-Dts.manualmode</code> - Tests with manual mode Arquillian containers.</p>
</li>
<li>
<p><code>-Dts.bench</code> - Benchmark tests.</p>
</li>
<li>
<p><code>-Dts.stress</code> - Stress tests.</p>
</li>
<li>
<p><code>-Dts.domain</code> - Domain mode tests.</p>
</li>
<li>
<p><code>-Dts.compat</code> - Compatibility tests.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples"><a class="anchor" href="#examples"></a>2.2. Examples</h3>
<div class="ulist">
<ul>
<li>
<p><code>integration-tests.sh [install] ` `</code> <code>-- Runs smoke tests.</code></p>
</li>
<li>
<p><code>integration-tests.sh clean install&#8201;&#8212;&#8201;Cleans the target directory, then runs smoke tests.</code></p>
</li>
<li>
<p><code>integration-tests.sh install -Dts.smoke ` `</code> <code>-- Same as above.</code></p>
</li>
<li>
<p><code>integration-tests.sh install -DallTests ` `</code>
<code>-- Runs all testsuite tests.</code></p>
</li>
<li>
<p><code>integration-tests.sh install -Dts.stress&#8201;&#8212;&#8201;Runs smoke tests and stress tests.</code></p>
</li>
<li>
<p><code>integration-tests.sh install -Dts.stress -Dts.noSmoke&#8201;&#8212;&#8201;Runs stress tests only.</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Pure maven</strong> - if you prefer not to use scripts, you may achieve the
same result with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mvn &#8230;&#8203; -rf testsuite</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>-rf &#8230;&#8203;</code> parameter stands for "resume from" and causes Maven to run
the specified module <em>and all successive</em>.</p>
</div>
<div class="paragraph">
<p>It&#8217;s possible to run only a single module (provided the ancestor modules
were already run to create the AS copies) :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mvn &#8230;&#8203; -pl testsuite/integration/cluster</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>-pl &#8230;&#8203;</code> parameter stands for "project list" and causes Maven to
run the specified module <em>only</em>.</p>
</div>
<div class="sect3">
<h4 id="output-to-console"><a class="anchor" href="#output-to-console"></a>2.2.1. Output to console</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java">-DtestLogToFile</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="other-options"><a class="anchor" href="#other-options"></a>2.2.2. Other options</h4>
<div class="paragraph">
<p><code>-DnoWebProfile</code> - Run all tests with the <em>full</em> profile (
<code>standalone-full.xml</code>). By default, most tests are run under <em>web</em>
profile ( <code>standalone.xml</code>).</p>
</div>
<div class="paragraph">
<p><code>-Dts.skipTests</code> - Skip testsuite&#8217;s tests. Defaults to the value of
<code>-DskipTests</code>, which defaults to <code>false</code>. To build AS, skip unit tests
and run testsuite, use <code>-DskipTests -Dts.skipTests=false</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="timeouts"><a class="anchor" href="#timeouts"></a>2.2.3. Timeouts</h4>
<div class="sect4">
<h5 id="surefire-execution-timeout"><a class="anchor" href="#surefire-execution-timeout"></a>Surefire execution timeout</h5>
<div class="paragraph">
<p>Unfortunatelly, no math can be done in Maven, so instead of applying a
timeout ratio, you need to specify timeout manually for Surefire.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java">-Dsurefire.forked.process.timeout=<span class="integer">900</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="in-test-timeout-ratios"><a class="anchor" href="#in-test-timeout-ratios"></a>In-test timeout ratios</h5>
<div class="paragraph">
<p>Ratio in prercent - 100 = default, 200 = two times longer timeouts for
given category.</p>
</div>
<div class="paragraph">
<p>Currently we have five different ratios. Later, it could be replaced
with just one generic, one for database and one for deployment
operations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java">-Dtimeout.ratio.fsio=<span class="integer">100</span>
-Dtimeout.ratio.netio=<span class="integer">100</span>
-Dtimeout.ratio.memio=<span class="integer">100</span>
-Dtimeout.ratio.proc=<span class="integer">100</span>
-Dtimeout.ratio.db=<span class="integer">100</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-a-single-test-or-specified-tests"><a class="anchor" href="#running-a-single-test-or-specified-tests"></a>2.2.4. Running a single test (or specified tests)</h4>
<div class="paragraph">
<p>Single test is run using <strong>-Dtest=&#8230;&#8203;</strong> . Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>./integration-tests.sh install</code> <code>-Dtest='*Clustered*'</code> <code>-Dintegration.module</code> <code>-Dts.clustering</code></p>
</li>
<li>
<p><code>./integration-tests.sh clean install -Dtest=org</code> <code>/</code> <code>jboss</code> <code>/</code> <code>as</code>
<code>/</code> <code>test</code> <code>/</code> <code>integration</code> <code>/</code> <code>ejb/async/*TestCase.java</code>
<code>-Dintegration.module</code> <code>-Dts.basic</code></p>
</li>
<li>
<p><code>cd testsuite; mvn install</code> <code>-Dtest='*Clustered*'</code>
<code>-Dts.basic</code>
<code># No need for -Dintegration.module - integration module is active by default.</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The same shortcuts listed in "Test groups" may be used to activate the
module and group profile.</p>
</div>
<div class="paragraph">
<p>Note that <code>-Dtest=</code> overrides <code>&lt;includes&gt;</code> and <code>&lt;exludes&gt;</code> defined in
pom.xml, so do not rely on them when using wildcards - all compiled test
classes matching the wildcard will be run.</p>
</div>
<div class="paragraph">
<p><strong>Which Surefire execution is used?</strong></p>
</div>
<div class="paragraph">
<p>Due to Surefire&#8217;s design flaw, tests run multiple times if there are
multiple surefire executions.<br>
To prevent this, if <code>-Dtest=</code>&#8230;&#8203; is specified, non-default executions
are disabled, and standalone-full is used for all tests.<br>
If you need it other way, you can overcome that need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>basic-integration-web.surefire with standalone.xml - Configure standalone.xml to be used as server config.</code></p>
</li>
<li>
<p><code>basic-integration-non-web.surefire - For tests included here, technically nothing changes.</code></p>
</li>
<li>
<p><code>basic-integration-2nd.surefire - Simply run the second test in another invocation of Maven.</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="running-against-existing-as-copy-not-the-one-from-buildtargetjboss-as-"><a class="anchor" href="#running-against-existing-as-copy-not-the-one-from-buildtargetjboss-as-"></a>2.2.5. Running against existing AS copy (not the one from</h4>
<div class="paragraph">
<p>build/target/jboss-as-*)</p>
</div>
<div class="paragraph">
<p><strong>-Djboss.dist=&lt;path/to/jboss-as&gt;</strong> will tell the testsuite to copy that
AS into submodules to run the tests against.</p>
</div>
<div class="paragraph">
<p>For example, you might want to run the testsuite against AS located in
<code>/opt/wildfly-8</code> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java">./integration-tests.sh -DallTests -Djboss.dist=/opt/wildfly-<span class="integer">8</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The difference between jboss.dist and jboss.home:</p>
</div>
<div class="paragraph">
<p>jboss.dist is the location of the tested binaries. It gets copied to
testsuite submodules.</p>
</div>
<div class="paragraph">
<p>jboss.home is internally used and points to those copied AS instances
(for multinode tests, may be even different for each AS started by
Arquillian).</p>
</div>
<div class="sect4">
<h5 id="running-against-a-running-jboss-as-instance"><a class="anchor" href="#running-against-a-running-jboss-as-instance"></a>Running against a running JBoss AS instance</h5>
<div class="paragraph">
<p>Arquillian&#8217;s WildFly 39 container adapter allows specifying
<code>allowConnectingToRunningServer</code> in <code>arquillian.xml</code>, which makes it
check whether AS is listening at <code>managementAddress:managementPort</code>, and
if so, it uses that server instead of launching a new one, and doesn&#8217;t
shut it down at the end.</p>
</div>
<div class="paragraph">
<p>All arquillian.xml&#8217;s in the testsuite specify this parameter. Thus, if
you have a server already running, it will be re-used.</p>
</div>
</div>
<div class="sect4">
<h5 id="running-against-jboss-enterprise-application-platform-eap-6.0"><a class="anchor" href="#running-against-jboss-enterprise-application-platform-eap-6.0"></a>Running against JBoss Enterprise Application Platform (EAP) 6.0</h5>
<div class="paragraph">
<p>To run the testsuite against AS included JBoss Enterprise Application
Platform 6.x (EAP), special steps are needed.</p>
</div>
<div class="paragraph">
<p>Assuming you already have the sources available, and the distributed EAP
maven repository unzipped in e.g. <code>/opt/jboss/eap6-maven-repo/</code> :</p>
</div>
<div class="paragraph">
<p>1) Configure maven in settings.xml to use only the EAP repository. This
repo contains all artifacts necessary for building EAP, including maven
plugins.<br>
The build (unlike running testsuite) may be done offline.<br>
The recommended way of configuring is to use special settings.xml, not
your local one (typically in .m2/settings.xml).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml">   <span class="tag">&lt;mirror&gt;</span>
      <span class="tag">&lt;id&gt;</span>eap6-mirror-setting<span class="tag">&lt;/id&gt;</span>
      <span class="tag">&lt;mirrorOf&gt;</span>
         *,!central-eap6,!central-eap6-plugins,!jboss-public-eap6,!jboss-public-eap6-plugins
      <span class="tag">&lt;/mirrorOf&gt;</span>
      <span class="tag">&lt;name&gt;</span>Mirror Settings for EAP 6 build<span class="tag">&lt;/name&gt;</span>
      <span class="tag">&lt;url&gt;</span>file:///opt/jboss/eap6-maven-repo<span class="tag">&lt;/url&gt;</span>
    <span class="tag">&lt;/mirror&gt;</span>
  <span class="tag">&lt;/mirrors&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>\2) Build EAP. You won&#8217;t use the resulting EAP build, though. The
purpose is to get the artifacts which the testsuite depends on.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">mvn clean install -s settings.xml -Dmaven.repo.local=local-repo-eap</code></pre>
</div>
</div>
<div class="paragraph">
<p>\3) Run the testsuite. Assuming that EAP is located in <code>/opt/eap6</code>, you
would run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">./integration-tests.sh -DallTests -Djboss.dist=/opt/eap6</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-with-a-debugger"><a class="anchor" href="#running-with-a-debugger"></a>2.2.6. Running with a debugger</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Argument</th>
<th class="tableblock halign-left valign-top">What will start with debugger</th>
<th class="tableblock halign-left valign-top">Default port</th>
<th class="tableblock halign-left valign-top">Port change arg.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-Ddebug</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AS instances run by Arquillian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8787</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-Das.debug.port=&#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-Djpda</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">alias for -Ddebug</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-DdebugClient</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test JVMs (currently Surefire)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5050</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-Ddebug.port.surefire=&#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-DdebugCLI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AS CLI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5051</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-Ddebug.port.cli=&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="examples-1"><a class="anchor" href="#examples-1"></a>Examples</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">./integration-tests.sh install -DdebugClient -Ddebug.port.surefire=4040

...

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Listening for transport dt_socket at address: 4040</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>./integration-tests.sh install -DdebugClient -Ddebug.port.surefire

...

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Listening for transport dt_socket at address: 5050</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">./integration-tests.sh install -Ddebug</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">./integration-tests.sh install -Ddebug -Das.debug.port=5005</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
JBoss AS is started by Arquillian, when the first test which requires
given instance is run. Unless you pass <strong>-DtestLogToFile=false,</strong> <strong>there&#8217;s
(currently) no challenge text in the console</strong>; it will look like the
first test is stuck. This is being solved in
<a href="http://jira.codehaus.org/browse/SUREFIRE-781" class="bare">http://jira.codehaus.org/browse/SUREFIRE-781</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Depending on which test group(s) you run, multiple AS instances may be
started. In that case, you need to attach the debugger multiple times.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="debugging-clustering-tests"><a class="anchor" href="#debugging-clustering-tests"></a>Debugging clustering tests</h5>
<div class="paragraph">
<p>With the implementation of <a href="https://issues.redhat.com/browse/WFLY-276">WFLY-276</a> for the clustering test suite module,
these tests can be run with the debugger as well.
Here are some tips on how to effectively debug:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Prepare your IDE with 4 remote debugger sessions templates: <code>node1</code> with port 8787, <code>node2</code> with port 8788, <code>node3</code> with port 8789, and <code>node4</code> with port 8790.</p>
</li>
<li>
<p>Using <code>mvn</code>, run a single test (<code>-Dtest=..</code>) in the debug mode (<code>-Ddebug</code> / <code>-Djpda</code>)</p>
</li>
<li>
<p>Connect the debugger to each node as they are starting since the JVM is configured to wait for the debugger connection to proceed.</p>
</li>
<li>
<p>Keep connecting to starting nodes as some tests change the topology during the test.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Container start timeout in Arquillian is currently set to 60 seconds,
you may need to increase the timeout depending on your swiftness with connecting the remote debugger.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-with-custom-database"><a class="anchor" href="#running-tests-with-custom-database"></a>2.2.7. Running tests with custom database</h4>
<div class="paragraph">
<p>To run with different database, specify the <code>-Dds</code> and use these
properties (with the following defaults):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">-Dds.jdbc.driver=
-Dds.jdbc.driver.version=
-Dds.jdbc.url=
-Dds.jdbc.user=test
-Dds.jdbc.pass=test
-Dds.jdbc.driver.jar=${ds.db}-jdbc-driver.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>driver</code> is JDBC driver class. JDBC <code>url</code>, <code>user</code> and <code>pass</code> is as
expected.</p>
</div>
<div class="paragraph">
<p><code>driver.version</code> is used for automated JDBC driver downloading. Users
can set up internal Maven repository hosting JDBC drivers, with
artifacts with</p>
</div>
<div class="paragraph">
<p>GAV = <code>jdbcdrivers:${ds.db}:${ds.jdbc.driver.version</code>}</p>
</div>
<div class="paragraph">
<p>Internally, JBoss has such repo at
<a href="http://nexus.qa.jboss.com:8081/nexus/content/repositories/thirdparty/jdbcdrivers/" class="bare">http://nexus.qa.jboss.com:8081/nexus/content/repositories/thirdparty/jdbcdrivers/</a>
.</p>
</div>
<div class="paragraph">
<p>The <code>ds.db</code> value is set depending on ds. E.g. <code>-Dds=mssql2005</code> sets
<code>ds.db=mssql</code> (since they have the same driver). <code>-Dds.db</code> may be
overridden to use different driver.</p>
</div>
<div class="paragraph">
<p><strong class="line-through">In case you don&#8217;t want to use such driver, set just
-Dds.db= (empty) and provide the driver to the AS manually.</strong><br>
<em>Not supported; work in progress on parameter to provide JDBC Driver
jar.</em></p>
</div>
<div class="sect4">
<h5 id="default-values"><a class="anchor" href="#default-values"></a>Default values</h5>
<div class="paragraph">
<p>For WildFly continuous integration, there are some predefined values for
some of databases, which can be set using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">-Dds.db=&lt;database-identifier&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where database-identifier is one of: <code>h2</code>, <code>mysql51</code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-with-ipv6"><a class="anchor" href="#running-tests-with-ipv6"></a>2.2.8. Running tests with IPv6</h4>
<div class="paragraph">
<p><code>-Dipv6</code> - Runs AS with
<code>-Djava.net.preferIPv4Stack=false -Djava.net.preferIPv6Addresses=true</code></p>
</div>
<div class="paragraph">
<p>and the following defaults, overridable by respective parameter:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">IPv4 default</th>
<th class="tableblock halign-left valign-top">IPv6 default</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-Dnode0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">127.0.0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">::1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single-node tests.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-Dnode1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">127.0.0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">::1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Two-node tests (e.g. cluster) use this for the
2nd node.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-Dmcast</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">230.0.0.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ff01::1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ff01::1 is IPv6 Node-Local scope mcast
addr.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-Dmcast.jgroupsDiag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">224.0.75.75</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ff01::2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JGroups diagnostics
multicast address.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-Dmcast.modcluster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">224.0.1.105</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ff01::3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mod_cluster multicast
address.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Values are set in AS configuration XML, replaced in resources (like
ejb-jar.xml) and used in tests.</p>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-with-security-manager-custom-security-policy"><a class="anchor" href="#running-tests-with-security-manager-custom-security-policy"></a>2.2.9. Running tests with security manager / custom security policy</h4>
<div class="paragraph">
<p><code>-Dsecurity.manager</code> - Run with default policy.</p>
</div>
<div class="paragraph">
<p><code>-Dsecurity.policy=&lt;path&gt;</code> - Run with the given policy.</p>
</div>
<div class="paragraph">
<p><code>-Dsecurity.manager.other=&lt;set of Java properties&gt;</code> - Run with the given
properties. Whole set is included in all server startup parameters.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>./integration-tests.sh clean install -Dintegration.module -DallTests \
\&quot;-Dsecurity.manager.other=-Djava.security.manager \
-Djava.security.policy==$(pwd)/testsuite/shared/src/main/resources/secman/permitt_all.policy \
-Djava.security.debug=access:failure \&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice the \" quotes delimiting the whole <code>-Dsecurity.manager.other</code>
property.</p>
</div>
</div>
<div class="sect3">
<h4 id="creating-test-reports"><a class="anchor" href="#creating-test-reports"></a>2.2.10. Creating test reports</h4>
<div class="paragraph">
<p>Test reports are created in the form known from EAP 5. To create them,
simply run the testsuite, which will create Surefire XML files.</p>
</div>
<div class="paragraph">
<p>Creation of the reports is bound to the <code>site</code> Maven phase, so it must
be run separately afterward. Use one of these:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>./integration-tests.sh site
cd testsuite; mvn site
mvn -pl testsuite site</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that it will take all test results under <code>testsuite/integration/</code> -
the pattern is <code>**/*TestCase.xml</code>, without need to specify <code>-DallTests</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="creating-coverage-reports"><a class="anchor" href="#creating-coverage-reports"></a>2.2.11. Creating coverage reports</h4>
<div class="paragraph">
<p><strong>Jira:</strong> <a href="https://issues.redhat.com/browse/WFLY-585" class="bare">https://issues.redhat.com/browse/WFLY-585</a></p>
</div>
<div class="paragraph">
<p>Coverage reports are created by
<a href="http://www.eclemma.org/jacoco/trunk/index.html">JaCoCo</a>.</p>
</div>
<div class="paragraph">
<p>During the integration tests, Arquillian is passed a JVM argument which
makes it run with JaCoCo agent, which records the executions into
<code>${basedir}/target/jacoco</code> .</p>
</div>
<div class="paragraph">
<p>In the <code>site</code> phase, a HTML, XML and CSV reports are generated. That is
done using <code>jacoco:report</code> Ant task in <code>maven-ant-plugin</code> since JaCoCo&#8217;s
maven report goal doesn&#8217;t support getting classes outside
target/classes.</p>
</div>
<div class="sect4">
<h5 id="usage-integration-testsuite"><a class="anchor" href="#usage-integration-testsuite"></a>Usage</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>./build.sh clean install -DskipTests
./integration-tests.sh clean install -DallTests -Dcoverage
./integration-tests.sh site -DallTests -Dcoverage ## Must run in separatedly.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternative:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>mvn clean install -DskipTests
mvn -rf testsuite clean install -DallTests -Dcoverage
mvn -rf testsuite site -DallTests -Dcoverage</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="cleaning-the-project"><a class="anchor" href="#cleaning-the-project"></a>2.2.12. Cleaning the project</h4>
<div class="paragraph">
<p>To have most stable build process, it should start with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>clean target directories</p>
</li>
<li>
<p>only central Maven repo configured</p>
</li>
<li>
<p>clean local repository or at least:</p>
<div class="ulist">
<ul>
<li>
<p>free of artefacts to be built</p>
</li>
<li>
<p>free of dependencies to be used (especially snapshots)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>To use , you may use these commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>mvn clean install -DskipTests -DallTests  ## ...to clean all testsuite modules.
mvn dependency:purge-local-repository build-helper:remove-project-artifact -Dbuildhelper.removeAll</code></pre>
</div>
</div>
<div class="paragraph">
<p>In case the build happens in a shared environment (e.g. network disk),
it&#8217;s recommended to use local repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">cp /home/jenkins/.m2/settings.xml .
sed &quot;s|&lt;settings&gt;|&lt;settings&gt;&lt;localRepository&gt;/home/jenkins/jenkins-repos/$JOBNAME&lt;/localRepository&gt;|&quot; -i settings.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">mvn clean install ... -Dmaven.repo.local=localrepo</code></pre>
</div>
</div>
<div class="paragraph">
<p>See also <a href="https://issues.redhat.com/browse/WFLY-628" class="bare">https://issues.redhat.com/browse/WFLY-628</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="WildFly_Testsuite_Harness_Developer_Guide"><a class="anchor" href="#WildFly_Testsuite_Harness_Developer_Guide"></a>3. WildFly Testsuite Harness Developer Guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The testsuite implementation was tracked by <a href="https://issues.redhat.com/browse/WFLY-576">WFLY-576</a>,
which still contains a lot of useful information.</p>
</div>
<div class="sect2">
<h3 id="adding-a-new-maven-plugin"><a class="anchor" href="#adding-a-new-maven-plugin"></a>3.1. Adding a new maven plugin</h3>
<div class="paragraph">
<p>The plugin version needs to be specified in jboss-parent at the <code>&lt;properties&gt;</code> section of the jboss-parent <a href="https://github.com/jboss/jboss-parent-pom/blob/main/pom.xml">pom.xml</a> file.</p>
</div>
</div>
<div class="sect2">
<h3 id="how-the-as-instance-is-built"><a class="anchor" href="#how-the-as-instance-is-built"></a>3.2. How the AS instance is built</h3>
<div class="paragraph">
<p>See <a href="#How_the_server_is_built_and_configured_for_testsuite_modules">How the JBoss AS instance is built and configured
for testsuite modules.</a></p>
</div>
</div>
<div class="sect2">
<h3 id="properties-and-their-propagation"><a class="anchor" href="#properties-and-their-propagation"></a>3.3. Properties and their propagation</h3>
<div class="paragraph">
<p>Propagated to tests through arquillian.xml:<br>
<code>&lt;property name="javaVmArguments"&gt;${server.jvm.args}&lt;/property&gt;</code><br>
TBD: <a href="https://issues.redhat.com/browse/ARQ-647" class="bare">https://issues.redhat.com/browse/ARQ-647</a></p>
</div>
<div class="sect3">
<h4 id="jboss-as-instance-dir"><a class="anchor" href="#jboss-as-instance-dir"></a>3.3.1. JBoss AS instance dir</h4>
<div class="paragraph">
<p><strong>integration/pom.xml</strong></p>
</div>
<div class="paragraph">
<p>(currently nothing)</p>
</div>
<div class="paragraph">
<p><strong>*-arquillian.xml</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;container</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jboss</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">default</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;configuration&gt;</span>
        <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jbossHome</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>${basedir}/target/jbossas<span class="tag">&lt;/property&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="server-jvm-arguments"><a class="anchor" href="#server-jvm-arguments"></a>3.3.2. Server JVM arguments</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;surefire.memory.args&gt;</span>-Xmx512m -XX:MaxPermSize=256m<span class="tag">&lt;/surefire.memory.args&gt;</span>
<span class="tag">&lt;surefire.jpda.args&gt;</span><span class="tag">&lt;/surefire.jpda.args&gt;</span>
<span class="tag">&lt;surefire.system.args&gt;</span>${surefire.memory.args} ${surefire.jpda.args}<span class="tag">&lt;/surefire.system.args&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ip-settings"><a class="anchor" href="#ip-settings"></a>3.3.3. IP settings</h4>
<div class="ulist">
<ul>
<li>
<p><code>${ip.server.stack}</code> used in <code>&lt;systemPropertyVariables&gt;/&lt;server.jvm.args&gt;</code> which is used in <code>*-arquillian.xml</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="testsuite-directories"><a class="anchor" href="#testsuite-directories"></a>3.3.4. Testsuite directories</h4>
<div class="ulist">
<ul>
<li>
<p><code>${jbossas.ts.integ.dir</code>}</p>
</li>
<li>
<p><code>${jbossas.ts.dir</code>}</p>
</li>
<li>
<p><code>${jbossas.project.dir</code>}</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="clustering-properties"><a class="anchor" href="#clustering-properties"></a>3.3.5. Clustering properties</h4>
<div class="ulist">
<ul>
<li>
<p>node0</p>
</li>
<li>
<p>node1</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="debug-parameters-propagation"><a class="anchor" href="#debug-parameters-propagation"></a>3.4. Debug parameters propagation</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;surefire.jpda.args&gt;</span><span class="tag">&lt;/surefire.jpda.args&gt;</span>       - default

<span class="tag">&lt;surefire.jpda.args&gt;</span>-Xrunjdwp:transport=dt_socket,address=${as.debug.port},server=y,suspend=y<span class="tag">&lt;/surefire.jpda.args&gt;</span> - activated by -Ddebug or -Djpda


testsuite/pom.xml:        <span class="tag">&lt;surefire.system.args&gt;</span>... ${surefire.jpda.args} ...<span class="tag">&lt;/surefire.system.args&gt;</span>
testsuite/pom.xml:                        <span class="tag">&lt;jboss.options&gt;</span>${surefire.system.args}<span class="tag">&lt;/jboss.options&gt;</span>

testsuite/integration/pom.xml:     <span class="tag">&lt;server.jvm.args&gt;</span>${surefire.system.args} ${jvm.args.ip.server} ${jvm.args.security} ${jvm.args.timeouts} -Dnode0=${node0} -Dnode1=


integration/pom.xml:
<span class="tag">&lt;server.jvm.args&gt;</span>${surefire.system.args} ${jvm.args.ip.server} ${jvm.args.security} ${jvm.args.timeouts} -Dnode0=${node0} -Dnode1=${node1} -DudpGroup=${udpGroup} ${jvm.args.dirs}<span class="tag">&lt;/server.jvm.args&gt;</span>

arquillian.xml:
<span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">javaVmArguments</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>${server.jvm.args} -Djboss.inst=${basedir}/target/jbossas<span class="tag">&lt;/property&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="How_the_server_is_built_and_configured_for_testsuite_modules"><a class="anchor" href="#How_the_server_is_built_and_configured_for_testsuite_modules"></a>3.5. How the WildFly is built and configured for testsuite modules</h3>
<div class="paragraph">
<p>WildFly instance is copied from <code>${jboss.dist}</code> to <code>testsuite/target/jbossas</code>.
This defaults to WildFly which is built by the project (<code>build/target/wildfly-*</code>).</p>
</div>
<div class="paragraph">
<p><strong>testsuite/pom.xml</strong></p>
</div>
<div class="paragraph">
<p>From <code>${jboss.home}</code> to <code>${basedir}/target/jbossas</code> phase <code>generate-test-resources</code>, goal <code>resource-plugin:copy-resources</code></p>
</div>
<div class="paragraph">
<p><strong>testsuite/integration/pom.xml</strong></p>
</div>
<div class="paragraph">
<p>phase process-test-resources: antrun-plugin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;ant</span> <span class="attribute-name">antfile</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${basedir}/src/test/scripts/basic-integration-build.xml</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;target</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">build-basic-integration</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;target</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">build-basic-integration-jts</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/ant&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Which invokes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;target</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">build-basic-integration</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">description</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Builds server configuration for basic-integration tests</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;build-server-config</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jbossas</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="comment">&lt;!-- .. --&gt;</span>
<span class="tag">&lt;/target&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Which invokes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="comment">&lt;!-- Copy the base distribution. --&gt;</span>
<span class="comment">&lt;!-- We exclude modules and bundles as they are read-only and we locate the via sys props. --&gt;</span>
<span class="tag">&lt;copy</span> <span class="attribute-name">todir</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@{output.dir}/@{name}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;fileset</span> <span class="attribute-name">dir</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@{jboss.dist}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;exclude</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">**/modules/**</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;exclude</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">**/bundles/**</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/fileset&gt;</span>
<span class="tag">&lt;/copy&gt;</span>

<span class="comment">&lt;!-- overwrite with configs from test-configs and apply property filtering --&gt;</span>
<span class="tag">&lt;copy</span> <span class="attribute-name">todir</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@{output.dir}/@{name}</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">overwrite</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">failonerror</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;fileset</span> <span class="attribute-name">dir</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@{test.configs.dir}/@{name}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;filterset</span> <span class="attribute-name">begintoken</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">endtoken</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;filter</span> <span class="attribute-name">token</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">node0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${node0}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;filter</span> <span class="attribute-name">token</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">node1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${node1}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;filter</span> <span class="attribute-name">token</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">udpGroup</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${udpGroup}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;filter-elements</span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/filterset&gt;</span>
<span class="tag">&lt;/copy&gt;</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="arquillian-config-file-location"><a class="anchor" href="#arquillian-config-file-location"></a>3.5.1. Arquillian config file location</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>-Darquillian.xml=some-file-or-classpath-resource.xml</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="WildFly_Testsuite_Test_Developer_Guide"><a class="anchor" href="#WildFly_Testsuite_Test_Developer_Guide"></a>4. WildFly Testsuite Test Developer Guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>See also:</strong> <a href="#WildFly_Integration_Testsuite_User_Guide">WildFly Integration Testsuite User Guide</a></p>
</div>
<div class="sect2">
<h3 id="pre-requisites"><a class="anchor" href="#pre-requisites"></a>4.1. Pre-requisites</h3>
<div class="paragraph">
<p>Please be sure to read <a href="#Pre-requisites_-_test_quality_standards">Pre-requisites - test quality standards</a> and follow those guidelines.</p>
</div>
</div>
<div class="sect2">
<h3 id="managementclient-and-modelnode-usage-example"><a class="anchor" href="#managementclient-and-modelnode-usage-example"></a>4.2. ManagementClient and ModelNode usage example</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span class="directive">final</span> ModelNode operation = <span class="keyword">new</span> ModelNode();
operation.get(ModelDescriptionConstants.OP).set(ModelDescriptionConstants.READ_RESOURCE_OPERATION);
operation.get(ModelDescriptionConstants.OP_ADDR).set(address);
operation.get(ModelDescriptionConstants.RECURSIVE).set(<span class="predefined-constant">true</span>);

<span class="directive">final</span> ModelNode result = managementClient.getControllerClient().execute(operation);
Assert.assertEquals(ModelDescriptionConstants.SUCCESS, result.get(ModelDescriptionConstants.OUTCOME).asString());</code></pre>
</div>
</div>
<div class="paragraph">
<p>ManagementClient can be obtained as described below.</p>
</div>
</div>
<div class="sect2">
<h3 id="arquillian-features-available-in-tests"><a class="anchor" href="#arquillian-features-available-in-tests"></a>4.3. Arquillian features available in tests</h3>
<div class="paragraph">
<p>@ServerSetup</p>
</div>
<div class="paragraph">
<p>TBD</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span class="annotation">@ContainerResource</span> <span class="directive">private</span> ManagementClient managementClient;
<span class="directive">final</span> ModelNode result = managementClient.getControllerClient().execute(operation);</code></pre>
</div>
</div>
<div class="paragraph">
<p>TBD</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span class="annotation">@ArquillianResource</span> <span class="directive">private</span> ManagementClient managementClient;
ModelControllerClient client = managementClient.getControllerClient();</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span class="annotation">@ArquillianResource</span> ContainerController cc;

<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> test() {
    cc.setup(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>, ...properties..)
    cc.start(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;arquillian&gt;</span>
    <span class="tag">&lt;container</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">mode</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">manual</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/arquillian&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span class="comment">// Targeted containers HTTP context.</span>
<span class="annotation">@ArquillianResource</span> <span class="predefined-type">URL</span> url;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span class="comment">// Targeted containers HTTP context where servlet is located.</span>
<span class="annotation">@ArquillianResource</span>(SomeServlet.class) <span class="predefined-type">URL</span> url;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span class="comment">// Targeted containers initial context.</span>
<span class="annotation">@ArquillianResource</span> <span class="predefined-type">InitialContext</span>|<span class="predefined-type">Context</span> context;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span class="comment">// The manual deployer.</span>
<span class="annotation">@ArquillianResource</span> Deployer deployer;</code></pre>
</div>
</div>
<div class="paragraph">
<p>See
<a href="https://docs.jboss.org/author/display/ARQ/Resource+injection">Arquillian&#8217;s
Resource Injection docs</a> for more info,
<a href="https://github.com/arquillian/arquillian-examples" class="bare">https://github.com/arquillian/arquillian-examples</a> for examples.</p>
</div>
<div class="paragraph">
<p>See also
<a href="https://docs.jboss.org/author/display/ARQ/Reference+Guide">Arquillian
Reference</a>.</p>
</div>
<div class="paragraph">
<p>Note to @ServerSetup annotation: It works as expected only on non-manual
containers. In case of manual mode containers it calls setup() method
after each server start up which is right (or actually before
deployment), but the tearDown() method is called only at AfterClass
event, i.e. usually after your manual shutdown of the server. Which
limits you on the ability to revert some configuration changes on the
server and so on. I cloned the annotation and changed it to fit the
manual mode, but it is still in my github branch :)</p>
</div>
</div>
<div class="sect2">
<h3 id="properties-available-in-tests"><a class="anchor" href="#properties-available-in-tests"></a>4.4. Properties available in tests</h3>
<div class="sect3">
<h4 id="directories"><a class="anchor" href="#directories"></a>4.4.1. Directories</h4>
<div class="ulist">
<ul>
<li>
<p>jbosssa.project.dir - Project&#8217;s root dir (where ./build.sh is).</p>
</li>
<li>
<p>jbossas.ts.dir - Testsuite dir.</p>
</li>
<li>
<p>jbossas.ts.integ.dir - Testsuite&#8217;s integration module dir.</p>
</li>
<li>
<p>jboss.dist - Path to AS distribution, either built
(build/target/jboss-as-&#8230;&#8203;) or user-provided via -Djboss.dist</p>
</li>
<li>
<p>jboss.inst - (Arquillian in-container only) Path to the AS instance in
which the test is running (until ARQ-650 is possibly done)</p>
</li>
<li>
<p><strong class="line-through">jboss.home</strong> - Deprecated as it&#8217;s name is unclear and
confusing. Use jboss.dist or jboss.inst.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="networking"><a class="anchor" href="#networking"></a>4.4.2. Networking</h4>
<div class="ulist">
<ul>
<li>
<p>node0</p>
</li>
<li>
<p>node1</p>
</li>
<li>
<p>230.0.0.4</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="time-related-coefficients-ratios"><a class="anchor" href="#time-related-coefficients-ratios"></a>4.4.3. Time-related coefficients (ratios)</h4>
<div class="paragraph">
<p>In case some of the following causes timeouts, you may prolong the
timeouts by setting value &gt;= 100:</p>
</div>
<div class="paragraph">
<p>100 = leave as is,<br>
150 = 50 % longer, etc.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>timeout.ratio.gen - General ratio - can be used to adjust all timeouts. When this and specific are defined, both apply.</p>
</li>
<li>
<p>timeout.ratio.fs- Filesystem IO</p>
</li>
<li>
<p>timeout.ratio.net - Network IO</p>
</li>
<li>
<p>timeout.ratio.mem - Memory IO</p>
</li>
<li>
<p>timeout.ratio.cpu - Processor</p>
</li>
<li>
<p>timeout.ratio.db - Database</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Time ratios will soon be provided by
<code>org.jboss.as.test.shared.time.TimeRatio.for*()</code> methods.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="negative-tests"><a class="anchor" href="#negative-tests"></a>4.5. Negative tests</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Testing of invalid deployments is supposed to be leveraging the <code>@ShouldThrowException</code> annotation.
Unfortunately, this feature cannot be used at the moment due to outstanding issue, see <a href="https://issues.redhat.com/browse/WFLY-673">WFLY-673</a>.
However, the exception might be obtained using the manual deployer:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span class="annotation">@Deployment</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">X</span><span class="delimiter">&quot;</span></span>, managed = <span class="predefined-constant">false</span>)
<span class="comment">// ...</span>

<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> shouldFail(<span class="annotation">@ArquillianResource</span> Deployer deployer) <span class="directive">throws</span> <span class="exception">Exception</span> {
    <span class="keyword">try</span> {
        deployer.deploy(<span class="string"><span class="delimiter">&quot;</span><span class="content">X</span><span class="delimiter">&quot;</span></span>);
    } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
        <span class="comment">// do something</span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="clustering-tests-wfly-616"><a class="anchor" href="#clustering-tests-wfly-616"></a>4.6. Clustering tests (WFLY-616)</h3>
<div class="paragraph">
<p>You need to deploy the same thing twice, so two deployment methods that just return the same thing.
And then you have tests that run against each.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span class="annotation">@Deployment</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">deplA</span><span class="delimiter">&quot;</span></span>, testable = <span class="predefined-constant">false</span>)
    <span class="annotation">@TargetsContainer</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">serverB</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="directive">static</span> Archive&lt;?&gt; deployment() { ... }

    <span class="annotation">@Deployment</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">deplB</span><span class="delimiter">&quot;</span></span>, testable = <span class="predefined-constant">false</span>)
    <span class="annotation">@TargetsContainer</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">serverA</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="directive">static</span> Archive&lt;?&gt; deployment() { ... }

    <span class="annotation">@Test</span>
    <span class="annotation">@OperateOnDeployment</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">deplA</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> testA() { ... }

    <span class="annotation">@Test</span>
    <span class="annotation">@OperateOnDeployment</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">deplA</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> testA() {...}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="how-to-get-the-tests-to-main"><a class="anchor" href="#how-to-get-the-tests-to-main"></a>4.7. How to get the tests to main branch</h3>
<div class="ulist">
<ul>
<li>
<p>First of all, <strong>be sure to read the "Before you add a test" section</strong>.</p>
</li>
<li>
<p><strong>Fetch</strong> the newest main:
<code>git fetch upstream # Provided you have the wildfly/wildfly GitHub repo</code>
<code>as a remote called 'upstream'.</code></p>
</li>
<li>
<p><strong>Rebase</strong> your branch: git checkout WFLY-1234-your-branch; git rebase
upstream/main</p>
</li>
<li>
<p><strong>Run</strong> <strong><em>whole</em></strong> <strong>testsuite</strong> (integration-tests -DallTests). You may
use <a href="https://ci.wildfly.org/viewType.html?buildTypeId=WF_Nightly" class="bare">https://ci.wildfly.org/viewType.html?buildTypeId=WF_Nightly</a>.</p>
<div class="ulist">
<ul>
<li>
<p>If any tests fail and they do not fail in main, fix it and go back
to the "Fetch" step.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Push</strong> to a new branch in your GitHub repo:
<code>git push origin WFLY-1234-new-XY-tests</code></p>
</li>
<li>
<p><strong>Create a pull-request</strong> on GitHub. Go to your branch and click on
"Pull Request".</p>
<div class="ulist">
<ul>
<li>
<p>If you have a jira, start the title with it, like - WFLY-1234 New
tests for XYZ.</p>
</li>
<li>
<p>If you don&#8217;t, write some apposite title. In the description, describe
in detail what was done and why should it be merged. Keep in mind that
the diff will be visible under your description.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Keep the branch rebased daily</strong> until it&#8217;s merged (see the Fetch
step). If you don&#8217;t, you&#8217;re dramatically decreasing chance to get it
merged.</p>
</li>
<li>
<p>You might have someone with merge privileges to cooperate with you, so
they know what you&#8217;re doing, and expect your pull request.</p>
</li>
<li>
<p>When your pull request is reviewed and merged, you&#8217;ll be notified by
mail from GitHub.</p>
</li>
<li>
<p>You may also check if it was merged by the following:
<code>git fetch upstream; git cherry</code> <code>&lt;branch&gt; ## Or</code> git branch
--contains\{\{&lt;branch&gt; - see}} <code>here</code></p>
</li>
<li>
<p>Your commits will appear in main. They will have the same hash as in
your branch.</p>
<div class="ulist">
<ul>
<li>
<p>You are now safe to delete both your local and remote branches:
<code>git branch -D WFLY-1234-your-branch; git push origin :WFLY-1234-your-branch</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="How_to_Add_a_Test_Case"><a class="anchor" href="#How_to_Add_a_Test_Case"></a>5. How to Add a Test Case</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Thank you for finding time to contribute to WildFly quality.
Covering corner cases found by community users with tests is very important to increase stability.
If you&#8217;re providing a test case to support your bug report,
it&#8217;s very likely that your bug will be fixed much sooner.</p>
</div>
<div class="sect2">
<h3 id="create-a-test-case."><a class="anchor" href="#create-a-test-case."></a>5.1. Create a test case</h3>
<div class="paragraph">
<p>Don&#8217;t be discouraged, it&#8217;s quite easy - a simple use case may even consist of a single short <code>.java</code> file.</p>
</div>
<div class="paragraph">
<p>Check WildFly <a href="https://github.com/wildfly/wildfly/tree/main/testsuite/integration/basic/src/test/java/org/jboss/as/test/integration">test suite test cases</a> for examples.</p>
</div>
<div class="paragraph">
<p>For more information, see <a href="#WildFly_Testsuite_Test_Developer_Guide">WildFly Testsuite Test Developer Guide</a>.
Check the requirements for a test to be included in the testsuite.</p>
</div>
<div class="paragraph">
<p>Ask for help at WildFly Google user group or Zulip chat.</p>
</div>
</div>
<div class="sect2">
<h3 id="push-your-test-case-to-github-and-create-a-pull-request."><a class="anchor" href="#push-your-test-case-to-github-and-create-a-pull-request."></a>5.2. Push your test case to GitHub and create a pull request.</h3>
<div class="paragraph">
<p>For information on how to create a GitHub account and push your code therein,
see <a href="Hacking_On_WildFly.html">Hacking on WildFly</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Pre-requisites_-_test_quality_standards"><a class="anchor" href="#Pre-requisites_-_test_quality_standards"></a>6. Test Quality Standards</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All tests must follow these quality standards.</p>
</div>
<div class="sect2">
<h3 id="verify-the-test-belongs-in-wildfly"><a class="anchor" href="#verify-the-test-belongs-in-wildfly"></a>6.1. Verify the Test Belongs in WildFly</h3>
<div class="paragraph">
<p>Ensure the test validates current WildFly functionality.
Do not test the internal functionality of included libraries,
as those should be tested in the library&#8217;s upstream test suite.
However, do test the integration of those libraries with WildFly.</p>
</div>
</div>
<div class="sect2">
<h3 id="add-only-correct-and-understandable-tests"><a class="anchor" href="#add-only-correct-and-understandable-tests"></a>6.2. Add Only Correct and Understandable Tests</h3>
<div class="paragraph">
<p>Tests must be clear and verifiably correct.
If a test is overly complex or uses questionable logic,
refactor it to use clear logic or consult with the original author to clarify intent.</p>
</div>
</div>
<div class="sect2">
<h3 id="avoid-duplicate-tests"><a class="anchor" href="#avoid-duplicate-tests"></a>6.3. Avoid Duplicate Tests</h3>
<div class="paragraph">
<p>Before adding a test, verify that the functionality is not already covered elsewhere.
Use tools like <code>git grep</code> to search for existing test coverage.</p>
</div>
</div>
<div class="sect2">
<h3 id="use-descriptive-test-names"><a class="anchor" href="#use-descriptive-test-names"></a>6.4. Use Descriptive Test Names</h3>
<div class="paragraph">
<p>Test class and method names should clearly describe what is being tested.
Jira IDs alone are not descriptive and require external lookup to understand the test purpose.
Jira references may be included in test comments or commit messages, e.g. in Javadoc <code>@see</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="document-tests-with-javadoc"><a class="anchor" href="#document-tests-with-javadoc"></a>6.5. Document Tests with Javadoc</h3>
<div class="paragraph">
<p>All test classes and non-trivial test methods must include Javadoc explaining what functionality is being tested and why.</p>
</div>
</div>
<div class="sect2">
<h3 id="expand-existing-tests-when-appropriate"><a class="anchor" href="#expand-existing-tests-when-appropriate"></a>6.6. Expand Existing Tests When Appropriate</h3>
<div class="paragraph">
<p>When adding test coverage for functionality similar to an existing test, consider adding test methods to the existing test class rather than creating a new class.
Each new test class adds overhead to execution time.
Only create a new class when the functionality is sufficiently different to warrant separation.</p>
</div>
</div>
<div class="sect2">
<h3 id="organize-tests-by-subsystem"><a class="anchor" href="#organize-tests-by-subsystem"></a>6.7. Organize Tests by Subsystem</h3>
<div class="paragraph">
<p>Place integration tests in subpackages under the relevant subsystem (e.g., <code>org.jboss.as.test.integration.ejb.async</code>).
When a test involves multiple subsystems, place it under the package for the specification that defines the primary behavior being tested.</p>
</div>
</div>
<div class="sect2">
<h3 id="document-non-obvious-specification-requirements"><a class="anchor" href="#document-non-obvious-specification-requirements"></a>6.8. Document Non-Obvious Specification Requirements</h3>
<div class="paragraph">
<p>When testing behavior mandated by specifications but not immediately obvious, include comments explaining the requirement (e.g., "Verifies Jakarta EE X.Y.Z - Description of requirement").</p>
</div>
</div>
<div class="sect2">
<h3 id="collocate-test-resources-with-test-code"><a class="anchor" href="#collocate-test-resources-with-test-code"></a>6.9. Collocate Test Resources with Test Code</h3>
<div class="paragraph">
<p>Place integration test resources (deployment descriptors, configuration files, etc.) in the same source directory as the test class.
This keeps all test artifacts together and makes tests easier to understand.</p>
</div>
</div>
<div class="sect2">
<h3 id="use-configurable-values-for-urls-and-ports"><a class="anchor" href="#use-configurable-values-for-urls-and-ports"></a>6.10. Use Configurable Values for URLs and Ports</h3>
<div class="paragraph">
<p>Do not hard-code URLs, hostnames, ports, or IP addresses.
Use configurable values provided by Arquillian or system properties to ensure tests work with different configurations and IPv6 addresses.</p>
</div>
<div class="paragraph">
<p>If a necessary configuration property is missing, file a Jira issue with component "Testsuite".</p>
</div>
</div>
<div class="sect2">
<h3 id="follow-best-practices-for-commits"><a class="anchor" href="#follow-best-practices-for-commits"></a>6.11. Follow Best Practices for Commits</h3>
<div class="ulist">
<ul>
<li>
<p>Keep changes focused on the specific issue or feature being addressed.</p>
</li>
<li>
<p>Do not include unrelated changes such as reformatting or typo fixes in feature commits.
Submit these separately.</p>
</li>
<li>
<p>Prefer smaller, focused pull requests over large, difficult-to-review changes.</p>
</li>
<li>
<p>Maintain consistency across commits (e.g., when renaming, update all references).</p>
</li>
<li>
<p>Write clear commit messages that will be meaningful in the project history.</p>
</li>
<li>
<p>Include the Jira ID in commit messages when working on a tracked issue.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="avoid-blind-timeouts"><a class="anchor" href="#avoid-blind-timeouts"></a>6.12. Avoid Blind Timeouts</h3>
<div class="paragraph">
<p>Do not use <code>Thread.sleep()</code> without checking for the actual condition being awaited.
Use active waiting with timeouts or timeout mechanisms provided by the API being tested.</p>
</div>
<div class="paragraph">
<p>Make timeouts configurable with reasonable defaults.
For groups of similar tests, use a shared configurable timeout value.</p>
</div>
</div>
<div class="sect2">
<h3 id="provide-descriptive-assertion-messages"><a class="anchor" href="#provide-descriptive-assertion-messages"></a>6.13. Provide Descriptive Assertion Messages</h3>
<div class="paragraph">
<p>Always include descriptive messages in <code>assert*()</code> and <code>fail()</code> calls.
Clear messages make test failures easier to diagnose.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span class="comment">// Good</span>
assertTrue(<span class="string"><span class="delimiter">&quot;</span><span class="content">File config.xml should exist</span><span class="delimiter">&quot;</span></span>, configFile.exists());

<span class="comment">// Bad - provides no context on failure</span>
assertTrue(configFile.exists());</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="include-configuration-context-in-exceptions"><a class="anchor" href="#include-configuration-context-in-exceptions"></a>6.14. Include Configuration Context in Exceptions</h3>
<div class="paragraph">
<p>When tests fail due to possible misconfiguration, include the relevant configuration property names and values in exception messages.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="java"><span class="predefined-type">File</span> jdbcJar = <span class="keyword">new</span> <span class="predefined-type">File</span>(<span class="predefined-type">System</span>.getProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">jbossas.ts.dir</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">.</span><span class="delimiter">&quot;</span></span>), <span class="string"><span class="delimiter">&quot;</span><span class="content">integration/src/test/resources/mysql-connector-java-5.1.15.jar</span><span class="delimiter">&quot;</span></span>);
<span class="keyword">if</span> (!jdbcJar.exists()) {
    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">IllegalStateException</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Cannot find </span><span class="delimiter">&quot;</span></span> + jdbcJar + <span class="string"><span class="delimiter">&quot;</span><span class="content"> using ${jbossas.ts.dir} == </span><span class="delimiter">&quot;</span></span> + <span class="predefined-type">System</span>.getProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">jbossas.ts.dir</span><span class="delimiter">&quot;</span></span>));
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="clean-up-resources"><a class="anchor" href="#clean-up-resources"></a>6.15. Clean Up Resources</h3>
<div class="ulist">
<ul>
<li>
<p>Close all sockets, connections, streams, and file descriptors in <code>finally</code> blocks or use try-with-resources.</p>
</li>
<li>
<p>Avoid storing large objects in static fields.
If necessary, clear them in <code>finally</code> blocks.</p>
</li>
<li>
<p>Do not modify server configuration unless you restore it in a <code>finally</code> block or <code>@After*</code> method.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="keep-tests-configurable"><a class="anchor" href="#keep-tests-configurable"></a>6.16. Keep Tests Configurable</h3>
<div class="paragraph">
<p>Extract configuration values such as timeouts, paths, URLs, and counts into configurable properties defined at the beginning of the test class.
This improves test maintainability and flexibility.</p>
</div>
</div>
<div class="sect2">
<h3 id="follow-coding-standards"><a class="anchor" href="#follow-coding-standards"></a>6.17. Follow Coding Standards</h3>
<div class="paragraph">
<p>Coding standards for production code also apply to test code.
Please refer to <a href="Hacking_On_WildFly.html">Hacking on WildFly</a> for the coding standards.
Just to mention the most frequent violations, always include the copyright header:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/*
 * Copyright The WildFly Authors
 * SPDX-License-Identifier: Apache-2.0
 */</pre>
</div>
</div>
<div class="paragraph">
<p>and follow our import order for the project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import static *

import java.*
import javax.*

import others.*</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Shared_Test_Classes_and_Resources"><a class="anchor" href="#Shared_Test_Classes_and_Resources"></a>7. Shared Test Classes and Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="among-testsuite-modules"><a class="anchor" href="#among-testsuite-modules"></a>7.1. Among Testsuite Modules</h3>
<div class="paragraph">
<p>Use the testsuite/shared module.</p>
</div>
<div class="paragraph">
<p>Classes and resources in this module are available in all testsuite modules - i.e. in testsuite/*
Only use it if necessary - don&#8217;t put things "for future use" in there.
Don&#8217;t split packages across modules.
Make sure the java package is unique in the WildFly project.</p>
</div>
<div class="paragraph">
<p>Document your util classes* (javadoc) so they can be easily found and reused!
A generated list will be put here.</p>
</div>
</div>
<div class="sect2">
<h3 id="between-components-and-testsuite-modules"><a class="anchor" href="#between-components-and-testsuite-modules"></a>7.2. Between Components and Testsuite Modules</h3>
<div class="paragraph">
<p>To share component&#8217;s test classes with some module in testsuite,
you don&#8217;t need to split to submodules.
You can create a jar with classifier using this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>maven-jar-plugin<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;executions&gt;</span>
        <span class="tag">&lt;execution&gt;</span>
            <span class="tag">&lt;goals&gt;</span>
                <span class="tag">&lt;goal&gt;</span>test-jar<span class="tag">&lt;/goal&gt;</span>
            <span class="tag">&lt;/goals&gt;</span>
        <span class="tag">&lt;/execution&gt;</span>
    <span class="tag">&lt;/executions&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This creates a jar with classifier "tests", so you can add it as dependency to a testsuite module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml">    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.wildfly<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>wildfly-clustering-common<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;classifier&gt;</span>tests<span class="tag">&lt;/classifier&gt;</span>
        <span class="tag">&lt;version&gt;</span>${project.version}<span class="tag">&lt;/version&gt;</span>
        <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<hr />
<div id="footer" style="background: white; text-align: center">
  <p><img src="https://raw.githubusercontent.com/commonhaus/artwork/main/foundation/brand/project/svg/CF_logo_wildFly_default.svg" style="height: 120px;"/>
            <br />
            Copyright &copy; <a href="https://wildfly.org">WildFly</a>.<br />
            All rights reserved. For details on our trademarks, please visit our <a href="https://www.commonhaus.org/policies/trademark-policy/">Trademark Policy</a> and <a href="https://www.commonhaus.org/trademarks/">Trademark List</a>.<br />
            Trademarks of third parties are owned by their respective holders and their mention here does not suggest any endorsement or association.</p>
</div>
</body>
</html>